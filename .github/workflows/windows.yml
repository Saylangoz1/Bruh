name: Windows
on:
  workflow_dispatch:
    inputs:
      auth:
        description: 'Windows (CMD) Command from https://remotedesktop.google.com/headless'
        required: true
        type: 'string'


defaults:
  run:
    shell: cmd

jobs:
  deploy:
    runs-on: windows-latest
    timeout-minutes: 999999999
    steps:
    - uses: actions/checkout@v3
    - name: Create new Administrator user
      run: |
           net user runneradmin /active:no
           net user installer /active:no
           net user runneradmin /delete
           net user installer /delete
           net user /add Administrator Ananasor!31
           net localgroup Administrators /add Administrator
           REG ADD "HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon" /v AutoAdminLogon /t REG_SZ /d 1 /f
           REG ADD "HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon" /v DefaultUserName /t REG_SZ /d Administrator /f
           REG ADD "HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon" /v DefaultPassword /t REG_SZ /d Ananasor!31 /f
    - name: ðŸš€ Start!
      run: |
           echo Downloading Chrome Remote Desktop...
           start /wait curl https://dl.google.com/edgedl/chrome-remote-desktop/chromeremotedesktophost.msi --output file.msi > NUL
           echo Installing Chrome Remote Desktop...
           start /wait file.msi > NUL
           echo Starting Chrome Remote Desktop...
           start /wait "" ${{ github.event.inputs.auth }} --pin=123456 > NUL
           loop.bat
